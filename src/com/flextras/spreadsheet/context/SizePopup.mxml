<?xml version = "1.0" encoding = "utf-8"?>
<!---

-->
<context:BasePopup xmlns:fx = "http://ns.adobe.com/mxml/2009"
				   xmlns:s = "library://ns.adobe.com/flex/spark"
				   xmlns:mx = "library://ns.adobe.com/flex/mx"
				   xmlns:context="com.flextras.spreadsheet.context.*"
				   title = "Set size">
	<mx:Form>
		<mx:FormItem label="Set column width">
			<s:HSlider id = "widthSlider"
					   minimum = "0"
					   maximum = "300"
					   stepSize = "1"
					   value = "{grid.getColumnWidthAt(cell.location.column)}"
					   change = "widthSlider_changeHandler(event)" />
		</mx:FormItem>
		
		<mx:FormItem label="Set row height">
			<s:HSlider id = "heightSlider"
					   minimum = "0"
					   maximum = "300"
					   stepSize = "1"
					   value = "{grid.getRowHeightAt(cell.location.row)}"
					   change = "heightSlider_changeHandler(event)" />
		</mx:FormItem>
	</mx:Form>

	<fx:Script>
		<![CDATA[
			import com.flextras.paintgrid.CellProperties;
			
			/**
			 * @private
			 */			
			protected var _cell : CellProperties;
			
			[Bindable("cellChanged")]
			/**
			 * This is a reference to the cell being resized in the spreadsheet.
			 */			
			public function get cell () : CellProperties
			{
				return _cell;
			}
			/**
			 * @private
			 */			
			public function set cell (value : CellProperties) : void
			{
				if (_cell === value)
					return;
				
				_cell = value;
				
				dispatchEvent(new Event("cellChanged"));
			}
			
			/**
			 * @private
			 */			
			protected var _cells : Array;
			
			[Bindable("cellsChanged")]
			/**
			 * This is an array of cells that are selected the spreadsheet.
			 */			
			public function get cells () : Array
			{
				return _cells;
			}
			
			/**
			 * @private
			 */			
			public function set cells (value : Array) : void
			{
				if (_cells === value)
					return;
				
				_cells = value;
				
				dispatchEvent(new Event("cellsChanged"));
			}
			
			protected function widthSlider_changeHandler (event : Event) : void
			{
				if (cells && cells.length > 0)
					for each (var c : CellProperties in cells)
						grid.setColumnWidthAt(c.location.column, widthSlider.value);
				
				if (cell)
					grid.setColumnWidthAt(cell.location.column, widthSlider.value);
			}
			
			protected function heightSlider_changeHandler (event : Event) : void
			{
				if (cells && cells.length > 0)
					for each (var c : CellProperties in cells)
					grid.setRowHeightAt(c.location.row, heightSlider.value);
				
				if (cell)
					grid.setRowHeightAt(cell.location.row, heightSlider.value);
			}
		]]>
	</fx:Script>
</context:BasePopup>
